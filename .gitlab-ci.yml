variables:
  PROJECT_NAME: kubernetes-0.0.1-SNAPSHOT

stages:
  - build
  - test

# Build and Test are two different jobs in the same stage.
# This allows us to run these two sequentially and making build faster

# Job 1:
Build:
  stage: build
  # Gradle image on which this would be run to build the project
  image: maven:3.6.3-openjdk-11
  cache:
    paths:
      - .m2/repository
  before_script:
    - mvn clean
  script:
    - mvn package
  artifacts:
    #name: WAR File
    paths:
      - target/$PROJECT_NAME.jar
  only:
    changes:
      - "^src/.*"


# Job 2:
Test:
  stage: test
  # Gradle image on which this would be run to test the project
  image: maven:3.6.3-openjdk-11
  script:
    - mvn test
  # ToDo: Add coverage
  only:
    changes:
      - "^src/.*"